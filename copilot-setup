#!/usr/bin/env bash

AH_DIR="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" && pwd)"

bash "$AH_DIR/common-pre-setup"

SETUP_ENV="$("$AH_DIR/bin/get-task" --get-setup-env 2>/dev/null)"
if [ -n "$SETUP_ENV" ]; then
  while IFS= read -r line; do
    export "$line"
  done <<< "$SETUP_ENV"
fi

if [ -f .agents/copilot-setup ]; then
  .agents/copilot-setup
fi

if [ -f .agents/common-post-setup ]; then
  .agents/common-post-setup
fi

bash "$AH_DIR/common-post-setup"
